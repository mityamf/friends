!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="dist/",r(r.s=0)}([function(module,exports){function auth(){return new Promise((e,t)=>{VK.Auth.login(r=>{r.session?e():t(new Error("Ошибка авторизации"))},2)})}function callApi(e,t){return t.v="5.80",new Promise((r,n)=>{VK.api(e,t,e=>{e.error?n(e.error):r(e.response)})})}VK.init({apiId:6681223});let sourceArr={},selectedArr={items:[]};function renderFriends(e,t){const r=document.querySelector(t);r.innerHTML="";const n=document.querySelector("#template").textContent,o=Handlebars.compile(n)(e);r.innerHTML=o}auth().then(()=>callApi("friends.get",{order:name,fields:"photo_50"})).then(list=>{let savedFriends=localStorage.getItem("selectedFriends");savedFriends?(selectedArr=JSON.parse(savedFriends),renderFriends(selectedArr,".friends-list--selected"),sourceArr=deduction(list,selectedArr),renderFriends(sourceArr,".friends-list--source")):(renderFriends(list,".friends-list--source"),sourceArr=list);let filters=document.querySelectorAll(".friends__filter-input");filters.forEach(filter=>{const sourceName=filter.parentElement.classList[1].split("--")[1];let data=eval(sourceName+"Arr");filter.addEventListener("keyup",filterFunction.bind(null,data,sourceName))})});const sourceZone=document.querySelector(".source"),targetZone=document.querySelector(".selected");function makeDnD(e){let t;sourceZone.addEventListener("dragstart",e=>{e.dataTransfer.setData("text/plain","node"),t={source:sourceZone,node:e.target}}),e.forEach(e=>{e.addEventListener("dragover",e=>e.preventDefault())}),targetZone.addEventListener("drop",e=>{if(t){if(e.preventDefault(),t.source!==targetZone){targetZone.querySelector(".friends-list").appendChild(t.node);const e=t.node.dataset.id;moveDataToArray(sourceArr,selectedArr,e)}t=null}})}function elementClick(e){if(e.target.classList.contains("friends-list__btn")){let t=e.target,r=t.parentNode;t.parentNode.parentNode.classList.contains("friends-list--source")?(targetZone.querySelector(".friends-list").appendChild(r),moveDataToArray(sourceArr,selectedArr,r.dataset.id)):t.parentNode.parentNode.classList.contains("friends-list--selected")&&(sourceZone.querySelector(".friends-list").appendChild(r),moveDataToArray(selectedArr,sourceArr,r.dataset.id))}}function deduction(e,t){for(let r=0;r<t.items.length;r++)deleteRecord(e.items,t.items[r].id);return e}function filterFunction(e,t,r){let n=r.target.value,o={items:[]};e.items.forEach(e=>{(isMatching(e.first_name,n)||isMatching(e.last_name,n))&&o.items.push(e)});let i=".friends-list--"+t.toString();renderFriends(o,i)}function isMatching(e,t){if(e.toLowerCase().indexOf(t.toLowerCase())>=0)return!0}function moveDataToArray(e,t,r){e.items.forEach((n,o)=>{n.id==r&&(t.items.push(n),e.items.splice(o,1))})}function deleteRecord(e,t){e.forEach((r,n)=>{r.id==t&&e.splice(n,1)})}makeDnD([sourceZone,targetZone]),document.querySelector(".main").addEventListener("click",elementClick),document.querySelector(".footer__btn").addEventListener("click",()=>{const e=JSON.stringify(selectedArr);localStorage.setItem("selectedFriends",e)})}]);
//# sourceMappingURL=main.js.map